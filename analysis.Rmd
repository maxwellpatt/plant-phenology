### Overview

Add overview here

First. let's import the necessary libraries.

```{r, message=FALSE}
library(terra)
library(sf)
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
library(here)
library(tmap)
library(cowplot)

rm(list = ls())
```

### NDVI Computation

Creating a function to calculate NDVI, which is a standardized index allowing us to assess whether the target observed contains live green vegetation or not.

```{r}
ndvi_fun = function(nir, red){
  (nir - red) / (nir + red)
}
```

#### Processing Individual Scenes

Load and process the Landsat scenes, updating the band names to reflect the actual spectral bands and applying the NDVI function.

```{r}
# loading Landsat from June 12 2018
landsat_20180612 <- rast(here("data/landsat_20180612.tif"))
names(landsat_20180612) <- c("blue", "green", "red", "NIR", "SWIR1", "SWIR2")

# apply NDVI function to compute the index 
ndvi_20180612 <- lapp(landsat_20180612[[c(4, 3)]], fun = ndvi_fun)

# show results
ndvi_20180612

```

#### Automating NDVI Across All Scenes

To enhance efficiency, we automate the NDVI calculations across all available scenes using a more streamlined approach.

```{r}
# generate a list of file paths for Landsat
files <- list.files(here("data"), pattern = "*.tif", full.names = TRUE)

# update function to create NDVI layers and stack them
create_ndvi_layer <- function(i){
  landsat <- rast(files[i])
  names(landsat) <- c("blue", "green", "red", "NIR", "SWIR1", "SWIR2")
  ndvi <- lapp(landsat[[c(4, 3)]], fun = ndvi_fun)
}

# apply function across al files to create a stack of NDVI layers
all_ndvi <- c(create_ndvi_layer(1),
              create_ndvi_layer(2),
              create_ndvi_layer(3),
              create_ndvi_layer(4),
              create_ndvi_layer(5),
              create_ndvi_layer(6),
              create_ndvi_layer(7),
              create_ndvi_layer(8))

# update layer names to match date
names(all_ndvi) <- c("2018-06-12",
                     "2018-08-15",
                     "2018-10-18",
                     "2018-11-03",
                     "2019-01-22",
                     "2019-02-23",
                     "2019-04-12",
                     "2019-07-01")

```
